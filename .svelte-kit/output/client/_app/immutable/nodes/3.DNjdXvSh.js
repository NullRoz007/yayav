import{d as C,c as h,a as r,t as f,b as $,s as x}from"../chunks/Bv2CX0pF.js";import{i as S}from"../chunks/0Eqm2C4h.js";import{y as I,L as m,C as X,I as l,B as P,D as V,E as q,K as z}from"../chunks/BZzQXbv5.js";import{i as j,a as F}from"../chunks/CWPEhIT3.js";import{y as i,g as w,j as A}from"../chunks/BvU8keI9.js";import{A as G,a as H}from"../chunks/CdaYFjyl.js";import{i as J}from"../chunks/oEOo3hgt.js";const g=async()=>{for(let t of i.enabled_rulesets)await j("yara_compile_rulesets",{paths:t.rules})},M=async()=>{var t=await j("yay_get_rulesets");return t},k=t=>{for(let e of i.enabled_rulesets)if(e.name===t.name)return!0;return!1},N=t=>{for(let e=0;e<i.enabled_rulesets.length;e++)if(i.enabled_rulesets[e].name===t.name)return e;return-1},Q=t=>{k(t)||i.enabled_rulesets.push(t)},T=t=>{if(k(t)){const e=N(t);i.enabled_rulesets.splice(e,1)}};var U=(t,e)=>{T(e.ruleset)},W=f('<button type="button" class="btn btn-sm variant-filled-primary" style="transform: translateX(-70%);">disable</button>'),Y=(t,e)=>{Q(e.ruleset)},Z=f('<button type="button" class="btn btn-sm variant-ghost" style="transform: translateX(-70%);">enable</button>');function B(t,e){I(e,!0);var c=h(),p=m(c);{var b=a=>{var n=W();n.__click=[U,e],r(a,n)},v=a=>{var n=Z();n.__click=[Y,e],r(a,n)};J(p,a=>{k(e.ruleset)?a(b):a(v,!1)})}r(t,c),X()}C(["click"]);var tt=f('<span class="chip variant-filled-primary"> </span>'),et=f('<!> <button type="button" class="btn btn-sm variant-filled-primary m-5">compile</button>',1);function ut(t,e){I(e,!1),S();var c=h(),p=m(c);F(p,M,null,(b,v)=>{var a=et(),n=m(a);w(n,1,()=>l(v),A,(d,u)=>{G(d,{children:(E,at)=>{H(E,{class:"variant-ghost-surface m-5",$$slots:{lead:(s,_)=>{var o=$();P(()=>x(o,l(u).name)),r(s,o)},summary:(s,_)=>{var o=$();o.nodeValue="",r(s,o)},content:(s,_)=>{var o=h(),K=m(o);w(K,1,()=>l(u).rules,A,(L,O)=>{var y=tt(),R=V(y,!0);q(y),P(()=>x(R,l(O))),r(L,y)}),r(s,o)},iconClosed:(s,_)=>{B(s,{get ruleset(){return l(u)}})},iconOpen:(s,_)=>{B(s,{get ruleset(){return l(u)}})}}})},$$slots:{default:!0}})});var D=z(n,2);D.__click=function(...d){g==null||g.apply(this,d)},r(b,a)}),r(t,c),X()}C(["click"]);export{ut as component};
