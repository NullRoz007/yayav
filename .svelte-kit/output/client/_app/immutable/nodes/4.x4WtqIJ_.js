import{d as O,c as B,a as r,t as m,s as g,b as C}from"../chunks/1bXq2FG_.js";import{i as D}from"../chunks/DLpg7eLt.js";import{y as S,K as p,H as V,J as h,E,F as R,G as k,C as n}from"../chunks/D2TcuHkd.js";import{a as H}from"../chunks/QVYOUX3U.js";import{i as j}from"../chunks/BIIlYxzt.js";import{e as I,i as J}from"../chunks/Ckouh465.js";import{y as _}from"../chunks/pf7KOJrY.js";import{A as L,a as M}from"../chunks/BIbgaxa6.js";import{i as F}from"../chunks/C_ntv7qB.js";const N=async()=>(console.log("!"),await F("get_ruleset_dir_path",{})),X=async()=>{for(let t of _.enabled_rulesets)await F("yara_compile_rulesets",{paths:t.rules})},Q=async()=>{var t=await F("yay_get_rulesets");return t},G=t=>{for(let e of _.enabled_rulesets)if(e.name===t.name)return!0;return!1},T=t=>{for(let e=0;e<_.enabled_rulesets.length;e++)if(_.enabled_rulesets[e].name===t.name)return e;return-1},U=t=>{G(t)||_.enabled_rulesets.push(t)},W=t=>{if(G(t)){const e=T(t);_.enabled_rulesets.splice(e,1)}};var Y=(t,e)=>{W(e.ruleset)},Z=m('<button type="button" class="btn btn-sm variant-filled-primary" style="transform: translateX(-70%);">disable</button>'),tt=(t,e)=>{U(e.ruleset)},et=m('<button type="button" class="btn btn-sm variant-ghost" style="transform: translateX(-70%);">enable</button>');function K(t,e){S(e,!0);var b=B(),d=p(b);{var x=s=>{var a=Z();a.__click=[Y,e],r(s,a)},f=s=>{var a=et();a.__click=[tt,e],r(s,a)};j(d,s=>{G(e.ruleset)?s(x):s(f,!1)})}r(t,b),V()}O(["click"]);var at=m('<div class="m-6"><h3 class="h3 ">Rulesets</h3> <blockquote class="blockquote mb-3">Compile and enable rulesets</blockquote> <blockquote class="blockquote mb-3" style="border-left-color: yellow;">Ensure your rulesets are installed at:<br> </blockquote></div>'),rt=m('<span class="chip variant-filled-primary m-1"> </span>'),st=m('<!> <button type="button" class="btn btn-sm variant-filled-primary mx-5">compile</button>',1),ot=m("<!> <!>",1);function pt(t,e){S(e,!1),D();var b=ot(),d=p(b);H(d,N,null,(f,s)=>{var a=at(),v=h(E(a),4),$=h(E(v),2);R(v),R(a),k(()=>g($,`${n(s)??""}/ruleset_name`)),r(f,a)});var x=h(d,2);H(x,Q,null,(f,s)=>{var a=st(),v=p(a);I(v,1,()=>n(s),J,(q,u)=>{L(q,{children:(z,lt)=>{M(z,{class:"variant-ghost-surface m-5 rounded-xl",$$slots:{lead:(l,y)=>{var i=B(),P=p(i);{var w=o=>{var c=C();k(()=>g(c,`${n(u).name??""} : compiled`)),r(o,c)},A=o=>{var c=C();k(()=>g(c,n(u).name)),r(o,c)};j(P,o=>{n(u).compiled?o(w):o(A,!1)})}r(l,i)},summary:(l,y)=>{var i=C();i.nodeValue="",r(l,i)},content:(l,y)=>{var i=B(),P=p(i);I(P,1,()=>n(u).rules,J,(w,A)=>{var o=rt(),c=E(o,!0);R(o),k(()=>g(c,n(A))),r(w,o)}),r(l,i)},iconClosed:(l,y)=>{K(l,{get ruleset(){return n(u)}})},iconOpen:(l,y)=>{K(l,{get ruleset(){return n(u)}})}}})},$$slots:{default:!0}})});var $=h(v,2);$.__click=function(...q){X==null||X.apply(this,q)},r(f,a)}),r(t,b),V()}O(["click"]);export{pt as component};
