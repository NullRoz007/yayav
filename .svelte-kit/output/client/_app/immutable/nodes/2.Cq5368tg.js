import{d as H,a,t as _,s as j,b as h,c as Y}from"../chunks/1bXq2FG_.js";import{i as J}from"../chunks/DLpg7eLt.js";import{y as K,H as U,K as G,J as p,E as v,F as l,C as u,G as q,T as Z,V as tt}from"../chunks/D2TcuHkd.js";import{r as et,e as T,i as V}from"../chunks/Ckouh465.js";import{i as rt,y as C,g as st,s as at}from"../chunks/pf7KOJrY.js";import{g as ot}from"../chunks/C8bEiUpu.js";import{A as F,a as I}from"../chunks/BIbgaxa6.js";async function N(c={}){return typeof c=="object"&&Object.freeze(c),await rt("plugin:dialog|open",{options:c})}var W=et(()=>C),lt=_('<button type="button" class="btn btn-sm variant-filled-primary" style="transform: translateX(-70%);">clear</button>');function X(c,d){K(d,!1);const n=()=>{W(W().log_messages=[])};J();var b=lt();b.__click=n,a(c,b),U()}H(["click"]);const nt=async(c,d)=>{const n=await N({multiple:!0,directory:!1});n.length!=0&&d(n,!1,!1)},it=async(c,d)=>{const n=await N({multiple:!0,directory:!0});n.length!=0&&d(n,!0,!1)};var ct=_('<li class="text-sm whitespace-normal break-words overflow-hidden"> </li>'),dt=_('<div class="card m-4 max-w-128"><header class="card-header"><div class="flex justify-between"><span> </span> <button type="button" class="btn btn-sm variant-filled-error ">x</button></div></header> <section class="p-4"><span>Paths:</span> <ol class="list max-w-full break-words"></ol></section> <footer class="card-footer"><span class="chip variant-filled-warning">Unscanned</span></footer></div>'),vt=(c,d)=>{d([],!1,!0)},ut=_('<div class="flex flex-wrap justify-center"></div> <div class="flex justify-end"><div class="btn-group variant-filled-primary"><button>Add file</button> <button>Add directory</button> <button>Add memory</button></div></div>',1);function _t(c,d){K(d,!1);const n=(e,s,t)=>{const o={paths:e,is_dirs:s,is_memory:t};C.targets.push(o)},b=e=>{C.targets.splice(e,1)};J();var L=ut(),x=G(L);T(x,5,()=>C.targets,V,(e,s,t)=>{var o=dt(),r=v(o),P=v(r),f=v(P),m=v(f);l(f);var S=p(f,2);S.__click=()=>{b(t)},l(P),l(r);var $=p(r,2),D=p(v($),2);T(D,5,()=>u(s).paths,V,(g,E)=>{var i=ct(),A=v(i,!0);l(i),q(()=>j(A,u(E))),a(g,i)}),l(D),l($),Z(2),l(o),q(()=>j(m,`Type: ${(u(s).is_dirs?"Directories":u(s).is_memory?"Memory":"Files")??""}`)),a(e,o)}),l(x);var M=p(x,2),y=v(M),w=v(y);w.__click=[nt,n];var k=p(w,2);k.__click=[it,n];var O=p(k,2);O.__click=[vt,n],l(y),l(M),a(c,L),U()}H(["click"]);var ft=_('<p class="overflow-hide"> </p>'),pt=(c,d,n)=>{d(u(n).rule)},mt=_('<button class="btn btn-sm variant-ghost-surface m-1">meta</button>'),$t=()=>{},gt=_('<li><button class="btn btn-sm variant-filled-warning m-1"> </button></li>'),bt=_("<ul></ul>"),ht=_("<pre> </pre>"),xt=_('<section class="bg-gray-900 max-h-64 overflow-auto p-4 mb-2"></section>'),yt=_('<div class="m-6"><h3 class="h3 ">Scan</h3> <blockquote class="blockquote">Select and scan targets.</blockquote></div> <!> <!> <!>',1);function Tt(c,d){K(d,!1);const n={Info:"text-blue-500",Warning:"text-yellow-500",Error:"text-red-500 font-bold",Success:"text-green-500",Match:"text-red-500 font-bold"},b=ot(),L=e=>{const s={id:"rule-drawer",meta:e};console.log(e),b.open(s)},x=e=>{let s=e.metadata.filter(t=>t[0]=="severity")[0];return s?s[1]:-1},M=e=>{var s="variant-ghost-surface";return console.log(e),e>0&&e<25?s="variant-ghost-secondary":e>=25&&e<50?s="variant-ghost-warning":(e>=50&&e<75||e>=75)&&(s="variant-ghost-error"),console.log(s),s};J();var y=yt(),w=p(G(y),2);F(w,{children:(e,s)=>{I(e,{class:"variant-ghost-surface m-5 rounded-xl",$$slots:{lead:(t,o)=>{var r=h("Targets");a(t,r)},summary:(t,o)=>{var r=h();r.nodeValue="",a(t,r)},content:(t,o)=>{_t(t,{})}}})},$$slots:{default:!0}});var k=p(w,2);F(k,{children:(e,s)=>{I(e,{class:"variant-ghost-surface m-5 rounded-xl",$$slots:{lead:(t,o)=>{var r=h("Matches");a(t,r)},summary:(t,o)=>{var r=h();r.nodeValue="",a(t,r)},content:(t,o)=>{F(t,{children:(r,P)=>{var f=Y(),m=G(f);T(m,1,st,V,(S,$)=>{const D=tt(()=>M(x(u($).rule)));I(S,{get class(){return`${u(D)??""} rounded-xl`},$$slots:{lead:(g,E)=>{var i=ft(),A=v(i,!0);l(i),q(()=>j(A,u($).rule.identifier)),a(g,i)},summary:(g,E)=>{var i=mt();i.__click=[pt,L,$],a(g,i)},content:(g,E)=>{var i=bt();T(i,5,()=>u($).matches,V,(A,Q)=>{var z=gt(),B=v(z);B.__click=[$t];var R=v(B,!0);l(B),l(z),q(()=>j(R,u(Q))),a(A,z)}),l(i),a(g,i)}}})}),a(r,f)},$$slots:{default:!0}})}}})},$$slots:{default:!0}});var O=p(k,2);F(O,{children:(e,s)=>{I(e,{class:"variant-ghost-surface m-5 rounded-xl",$$slots:{lead:(t,o)=>{var r=h("Logs");a(t,r)},summary:(t,o)=>{var r=h();r.nodeValue="",a(t,r)},content:(t,o)=>{var r=xt();T(r,5,()=>C.log_messages,V,(P,f)=>{var m=ht(),S=v(m,!0);l(m),q(()=>{at(m,`text-sm ${n[u(f).lvl]||"text-white"}`),j(S,u(f).msg)}),a(P,m)}),l(r),a(t,r)},iconClosed:(t,o)=>{X(t,{})},iconOpen:(t,o)=>{X(t,{})}}})},$$slots:{default:!0}}),a(c,y),U()}H(["click"]);export{Tt as component};
